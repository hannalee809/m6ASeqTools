% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/annotate_m6a.R
\name{annotate_m6a}
\alias{annotate_m6a}
\title{Annotate m6A Sites with External Feature Overlaps}
\usage{
annotate_m6a(
  m6a_df,
  annot_df,
  m6a_chr_col = "chr",
  m6a_start_col = "start",
  m6a_end_col = "end",
  m6a_strand_col = "strand",
  annot_chr_col = "chr",
  annot_start_col = "start",
  annot_end_col = "end",
  annot_strand_col = "strand",
  feature_col = NULL,
  zero_based = TRUE,
  ignore_strand = FALSE
)
}
\arguments{
\item{m6a_df}{A data frame containing m6A site coordinates. Must include
columns for chromosome, start, end, and strand.}

\item{annot_df}{A data frame containing annotation genomic intervals.
Must include columns for chromosome, start, end, and strand, plus an
annotation name column specified in \code{annot_name_col}.}

\item{m6a_chr_col}{Name of the m6A chromosome column.}

\item{m6a_start_col}{Name of the m6A start coordinate column.}

\item{m6a_end_col}{Name of the m6A end coordinate column.}

\item{m6a_strand_col}{Name of the m6A strand column.}

\item{annot_chr_col}{Name of the annotation chromosome column.}

\item{annot_start_col}{Name of the annotation start coordinate column.}

\item{annot_end_col}{Name of the annotation end coordinate column.}

\item{annot_strand_col}{Name of the annotation strand column.}

\item{feature_col}{Name of feature column in the annotation. (i.e. RBP_name, miRNA_ID, SNP_ID, etc.)}

\item{zero_based}{Whether input files contain 0-based genomic coordinates. Default is TRUE.}

\item{ignore_strand}{Logical; if FALSE (default), overlaps must occur on the
same strand. Set to TRUE to ignore strand information, useful for
annotations such as SNPs or regions lacking strand data.

#' @return A list containing two data frames:
\describe{
\item{\code{overlap_df}}{
A row-level table where each row corresponds to a single overlap event.
Includes:
\itemize{
\item \code{m6A_index}: index of the m6A site.
\item \code{feature_col}: annotation name provided by \code{annot_name_col}.
\item All additional annotation metadata columns.
}
}

\item{\code{annotated_m6A_df}}{
A perâ€“m6A-site summary table created by merging the m6A input with a
summarised annotation table. Contains:
\itemize{
\item Original m6A coordinates and metadata.
\item \code{Overlapping_Features}: semicolon-separated annotation names.
\item \code{Feature_Count}: number of unique annotations per m6A site.
}
}
}

Both inputs are internally converted to \code{GenomicRanges} objects.
Overlaps are detected using \code{findOverlaps()}. All annotation metadata
columns are preserved and attached to the overlap table.
A warning may be issued if the chromosome naming or reference genome differs
between the two inputs.}
}
\description{
This function identifies overlaps between m6A sites and a user-provided
genomic annotation dataset (e.g., RBP binding sites, enhancers, promoters,
etc.). The user specifies the required genomic coordinate columns
(\code{chr}, \code{start}, \code{end}, \code{strand}) and the column containing the
annotation name. All remaining columns in the
annotation dataset are retained and merged into the overlap table.
}
\examples{
\dontrun{
res <- annotate_m6a(
  m6a_df,
  annot_df,
  m6a_chr_col = "chr",
  m6a_start_col = "start",
  m6a_end_col = "end",
  m6a_strand_col = "strand",
  annot_chr_col = "chrom",
  annot_start_col = "start",
  annot_end_col = "end",
  annot_strand_col = "strand",
  annot_name_col = "RBP",
  zero_based = TRUE,
  ignore_strand = FALSE
)

res$overlap_df
res$annotated_m6A_df
}

}
