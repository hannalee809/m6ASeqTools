% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weighted_mod_ratio_and_DGE.R
\name{weighted_mod_ratio_and_DGE}
\alias{weighted_mod_ratio_and_DGE}
\title{Weighted Modification Ratio vs Differential Gene Expression Plot}
\usage{
weighted_mod_ratio_and_DGE(
  wmr_df,
  deseq,
  input_type = c("log2fc_wmr", "wmr_diff"),
  wmr_gene_col = "ensembl_gene_id",
  wmr_sig = list(p_val = NULL, diff = NULL),
  deseq_gene_col = "ensembl_gene_id",
  log2fc_col = "log2FoldChange",
  padj_col = "padj",
  group1_name = "Group1",
  group2_name = "Group2"
)
}
\arguments{
\item{wmr_df}{Data frame containing weighted modification ratio metrics.
Must include either \code{log2fc_weighted_mod_ratio} or
\code{median_diff} depending on \code{input_type}.}

\item{deseq}{DESeq2 results data frame containing gene-level differential
expression statistics.}

\item{input_type}{Character. Choose either:
\itemize{
\item \code{"log2fc_wmr"} â€“ use log2FC of weighted mod ratio.
\item \code{"wmr_diff"} â€“ use median WMR difference.
}}

\item{wmr_gene_col}{Column name in \code{wmr_df} storing gene IDs.}

\item{wmr_sig}{List specifying optional WMR significance thresholds for
\verb{input_type = "wmr_diff}:
\itemize{
\item \code{p_val}: p-value cutoff for WMR significance.
\item \code{diff}: minimum absolute log2FC or median difference.
}
Use \code{NULL} to disable a criterion.}

\item{deseq_gene_col}{Column name in \code{deseq} storing gene IDs.}

\item{log2fc_col}{Column name in \code{deseq} for gene log2 fold change.}

\item{padj_col}{Column name in \code{deseq} for adjusted p-values.}

\item{group1_name}{Name of condition/group 1 (used in labels).}

\item{group2_name}{Name of condition/group 2 (used in labels).}
}
\value{
A list containing:
\describe{
\item{plot}{A ggplot2 scatter plot.}
\item{data}{Merged data frame containing WMR + DGE values.}
}
}
\description{
This function merges weighted modification ratio (WMR) results with DESeq2
differential gene expression results and generates a scatter plot comparing
WMR changes to gene-level log2 fold changes. Users can either input the
results from \code{log2fc_weighted_mod_ratio} or \code{run_wmr_differential_test},
which they specify in the function argument. Users may specify significance
thresholds for WMR if they used the differential test. (p-value and/or
median/log2FC difference), which highlight points in blue Genes significant
in both WMR and DGE are highlighted in purple.
}
\details{
Significance coloring:
\itemize{
\item Purple = significant in both WMR and DGE.
\item Red = DGE only.
\item Blue = WMR only.
\item Black = not significant.
}

DGE significance is defined as:
\code{|log2FC| > 0.58} and \code{padj < 0.05}.
}
\examples{
weighted_mod_ratio_and_DGE_NEW(
  wmr_df,
  deseq_results,
  input_type = "wmr_diff",
  wmr_sig = list(p_val = 0.05, diff = 0.2)
)

}
